import{u as N,R as u,c as f,b as l,F as i,j as e,S as g,G as h,B as C,h as D,d as I,T as L}from"./index-e20a6fbb.js";import{D as y}from"./Dialog-28d74173.js";import{P as k}from"./PageHeader-0a00bc30.js";import{u as O,D as F}from"./DataGrid-4b8db2de.js";import"./Checkbox-2135657c.js";const B=()=>{const c=N(),[o,b]=u.useState(`${new Date}`),[a,r]=u.useState(`${new Date}`),[t,d]=u.useState([]),[m,p]=u.useState(),[v,S]=u.useState(0),T=async()=>{try{if(m===void 0)return;await f.leave.set.mutate({noOfDays:v,fromDate:o,toDate:a,leaveTypeId:m})}catch(n){D(n,c)}},s={id:"create-leave",labelId:"create-leave-label"};return u.useEffect(()=>{(async()=>{const n=await f.leaveType.getMany.query();d(n);const[w]=n;w!==void 0&&p(w.id)})()},[]),l(i,{children:[e(y.Trigger,{...s,variant:"primary",children:"Apply Leave"}),l(y,{...s,children:[e(y.Header,{title:"Add Leave"}),e(y.Body,{children:e(g,{gap:"3",children:l(h.Row,{gutters:"3",children:[e(h.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[e("input",{type:"number",className:"form-control",value:v,onChange:n=>S(parseInt(n.target.value))}),e("label",{htmlFor:"NoOfDays",children:"No Of Days"})]})}),e(h.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[e("input",{type:"date",className:"form-control",value:o,onChange:n=>b(n.target.value)}),e("label",{htmlFor:"From Date",children:"From Date"})]})}),e(h.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[e("input",{type:"date",className:"form-control",value:a,onChange:n=>r(n.target.value)}),e("label",{htmlFor:"TO Date",children:"To Date"})]})}),e(h.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[l("select",{className:"form-control",value:m,onChange:n=>p(parseInt(n.target.value)),children:[e("option",{value:void 0,children:"Select Leave Type"}),t.map(n=>e("option",{value:n.id,children:n.name}))]}),e("label",{htmlFor:"Leave Type",children:"Leave Type"})]})})]})})}),l(y.Footer,{children:[e(C,{variant:"outline-primary","data-bs-toggle":"modal","data-bs-target":`#${s.id}`,children:"Cancel"}),e(C,{variant:"primary",onClick:T,"data-bs-toggle":"modal","data-bs-target":`#${s.id}`,children:"Submit"})]})]})]})},A=c=>{const o=N(),[b,a]=u.useState([]),[r,t]=u.useState(),[d,m]=u.useState(""),[p,v]=u.useState(""),S=c.variant==="admin"?{labelId:"update-leave-status-model",id:"update-leave-status-model"}:{labelId:"update-leave-model",id:"update-leave-model"},T=async()=>{try{if(r===void 0)return;const s={id:c.leaveId,remarks:d,statusId:r},n=await f.leave.adminUpdate.mutate(s)}catch(s){D(s,o)}};return u.useEffect(()=>{v(c.variant)},[c.variant]),u.useEffect(()=>{(async()=>{const s=await f.leaveStatus.getMany.query();a(s);const[n]=s;n!==void 0&&t(n.id)})()},[]),l(i,{children:[e(y.Trigger,{...S,variant:"primary",children:c.variant==="admin"?"AddLeaveStatus":"Edit"}),e(y,{...S,children:l("form",{onSubmit:T,className:"was-validated",children:[e(y.Header,{title:"Add Leave Status"}),e(y.Body,{children:l(g,{gap:"3",children:[l(g,{children:[e("label",{children:"Remarks"}),e("input",{type:"text",className:"form-control",placeholder:"Remarks",value:d,onChange:s=>m(s.target.value),required:!0})]}),l(g,{children:[e("label",{htmlFor:"status",children:"Status"}),e("select",{className:"form-control",value:r,onChange:s=>t(parseInt(s.target.value)),children:b.map(s=>e("option",{value:s.id,children:s.name}))})]})]})}),e(y.Footer,{children:e("div",{style:{width:"100%",display:"flex",justifyContent:"space-evenly",alignItems:"center"},children:e(C,{variant:"primary",className:"center",type:"submit","data-bs-toggle":"modal","data-bs-target":`#${S.id}`,children:"Confirm"})})})]})})]})},E=()=>{const c=N(),o=O({load:async({states:a})=>{var r,t;try{const d={sortBy:(r=a.sortState)==null?void 0:r.sortBy,sortOrder:(t=a.sortState)==null?void 0:t.sortOrder,limit:a.paginationState.limit,page:a.paginationState.page};console.log({inputParameters:d});const m=await f.leave.getMany.mutate(d);return console.log({result:m}),{totalCount:m.totalCount,items:m.items}}catch(d){return D(d,c),{error:new Error("Something went wrong")}}}});return e(g,{gap:"3",children:e(I,{children:e(F,{...o,columns:[{id:"1",key:"",label:"Empcode",renderCell:a=>e(i,{children:a.user.id})},{id:"2",key:"",label:"Emp Name",renderCell:a=>{var r,t;return l(i,{children:[(r=a.user.personalInfo)==null?void 0:r.firstName," ",(t=a.user.personalInfo)==null?void 0:t.lastName]})}},{id:"3",key:"",label:"Requested On",renderCell:a=>l(i,{children:[" ",new Intl.DateTimeFormat("en-US",{month:"numeric",year:"numeric",day:"numeric"}).format(new Date(a.createdAt))]})},{id:"4",key:"",label:"Leave Type",renderCell:a=>e(i,{children:a.leaveType.name})},{id:"5",key:"",label:"From",renderCell:a=>e(i,{children:new Intl.DateTimeFormat("en-US",{month:"numeric",year:"numeric",day:"numeric"}).format(new Date(a.fromDate))})},{id:"6",key:"",label:"To",renderCell:a=>e(i,{children:new Intl.DateTimeFormat("en-US",{month:"numeric",year:"numeric",day:"numeric"}).format(new Date(a.toDate))})},{id:"7",key:"noOfDays",label:"Days",renderCell:a=>e(i,{children:a.noOfDays})},{id:"8",key:"remarks",label:"Remarks"},{id:"8",key:"",label:"Status",renderCell:a=>e(L,{transform:"capitalize",color:a.status.name==="accepted"?"success":a.status.name==="rejected"?"danger":"warning",children:a.status.name})},{id:"9",key:"",label:"Action",renderCell:a=>{var r;return e(i,{children:e(A,{variant:((r=c.state.user)==null?void 0:r.role.name)==="admin"?"admin":"employee",leaveId:a.id})})}}].filter(a=>{var r;return console.log({auth:c}),a.label!=="Action"||((r=c.state.user)==null?void 0:r.role.name)==="admin"})})})})},R=()=>{var b,a,r;const c=N(),o=O({load:async({states:t})=>{var d,m;try{const p={sortBy:(d=t.sortState)==null?void 0:d.sortBy,sortOrder:(m=t.sortState)==null?void 0:m.sortOrder,limit:t.paginationState.limit,page:t.paginationState.page};console.log({inputParameters:p});const v=await f.leave.getMany.mutate(p);return console.log({result:v}),{totalCount:v.totalCount,items:v.items}}catch(p){return console.log(p),D(p,c),{error:new Error("Something went wrong")}}}});return e(g,{gap:"3",children:e(I,{children:e(F,{...o,columns:[{id:"2",key:"",label:"Emp Name",renderCell:t=>e(i,{children:t.user.personalInfo?`${t.user.personalInfo.firstName} ${t.user.personalInfo.lastName}`:""}),sortOrder:((b=o.states.sortState)==null?void 0:b.sortBy)==="status"&&o.states.sortState.sortOrder?o.states.sortState.sortOrder:void 0,options:[{id:"1",as:"button",icon:"↑",label:"Sort by ASC",disabled:((a=o.states.sortState)==null?void 0:a.sortBy)==="status"&&o.states.sortState.sortOrder==="asc",onClick:()=>{o.dispatchers.sortDispatcher({type:"sort",payload:{sortBy:"status",sortOrder:"asc"}})}},{id:"2",as:"button",icon:"↓",label:"Sort by DESC",disabled:((r=o.states.sortState)==null?void 0:r.sortBy)==="status"&&o.states.sortState.sortOrder==="desc",onClick:()=>{o.dispatchers.sortDispatcher({type:"sort",payload:{sortBy:"status",sortOrder:"desc"}})}}]},{id:"3",key:"",label:"Leave Type",renderCell:t=>e(i,{children:t.leaveType.name})},{id:"4",key:"",label:"Available Units",renderCell:t=>e(i,{children:t.leaveType.daysAlloted})},{id:"5",key:"",label:"Balance Units",renderCell:t=>e(i,{children:Number(t.leaveType.daysAlloted)-Number(t.noOfDays)})},{id:"6",key:"",label:"Status",renderCell:t=>e(L,{transform:"capitalize",color:t.status.name==="accepted"?"success":t.status.name==="rejected"?"danger":"warning",children:t.status.name})}]})})})},q=()=>e(i,{children:l(g,{gap:"3",children:[l(h.Row,{children:[e(h.Col,{className:"py-2",cols:["12","md-2"],children:e("input",{type:"text",className:"form-control form-control-sm",placeholder:"From"})}),e(h.Col,{className:"py-2",cols:["12","md-2"],children:e("input",{type:"text",className:"form-control form-control-sm",placeholder:"To"})}),e(h.Col,{className:"py-2",cols:["12","md-2"],children:e("input",{type:"text",className:"form-control form-control-sm",placeholder:"Leave Type"})}),e(h.Col,{className:"py-2",cols:["12","md-2"],children:e(C,{variant:"primary",className:"w-100",children:"Search"})})]}),e(k,{title:e(k.Title,{}),actions:e(B,{})}),l("ul",{className:"nav nav-tabs",id:"myTab",role:"tablist",children:[e("li",{className:"nav-item",role:"presentation",children:e("button",{className:"nav-link active",id:"viewleave-tab","data-bs-toggle":"tab","data-bs-target":"#viewleave",type:"button",role:"tab","aria-controls":"viewleave","aria-selected":"true",children:"Leaves"})}),e("li",{className:"nav-item",role:"presentation",children:e("button",{className:"nav-link",id:"leavebalance-tab","data-bs-toggle":"tab","data-bs-target":"#leavebalance",type:"button",role:"tab","aria-controls":"leavebalance","aria-selected":"false",children:"Balance"})})]}),l("div",{className:"tab-content",id:"myTabContent",children:[e("div",{className:"tab-pane fade show active",id:"viewleave",role:"tabpanel","aria-labelledby":"viewleave-tab",children:e(E,{})}),e("div",{className:"tab-pane fade",id:"leavebalance",role:"tabpanel","aria-labelledby":"leavebalance-tab",children:e(R,{})})]})]})});export{q as LeaveTabs,q as default};
