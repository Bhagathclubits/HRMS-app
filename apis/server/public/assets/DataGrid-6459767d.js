import{b as i,S as $,j as n,T as A,R as r,B as S,e as a,r as L,F as B,f as R,g as j,i as z}from"./index-05c0ffa2.js";import{C as N}from"./Checkbox-4ab32b67.js";const O=e=>i($,{orientation:"horizontal",justifyContent:"between",alignItems:"center",children:[e.title,e.actions||null]}),F=e=>n(A,{as:"h5",...e});O.Title=F;const I=r.createContext(null),H=()=>{const e=r.useContext(I);if(!e)throw new Error("MenuContext is only accessible to the child components of the Menu component");return{props:e}},h=e=>i(I.Provider,{value:e,children:[e.trigger,e.dropdown]}),W="btn dropdown-toggle",_=e=>`${W} ${e.className}`,G=e=>{const t={...e};return n(S,{...t,type:"button",className:_(e),"data-bs-toggle":"dropdown","aria-expanded":"false",tabIndex:0})},V="dropdown-menu",q=e=>`${V} ${e.className}`,J=e=>{const t=H(),o={...e};return n(a,{as:"ul",...o,className:q(e),children:t.props.options.map(s=>L.createElement(X,{...s,key:s.id}))})},K="text-nowrap",Q={active:"active"},U={a:"dropdown-item",button:"dropdown-item",h6:"dropdown-header",hr:"dropdown-divider"},v=e=>`${K} ${U[e.as||"a"]} ${Q[e.status]} ${e.className}`,X=e=>{const t={...e};delete t.icon,delete t.label;const o=e.as||"a";return n(a,{as:"li",children:e.as==="hr"?n(o,{...t,className:v(e)}):i(o,{...t,className:v(e),href:"#",children:[e.icon?n("span",{style:{marginRight:16},children:e.icon}):null,n("span",{children:e.label})]})})};h.Trigger=G;h.Dropdown=J;const Y=(e,t)=>{switch(t.type){case"loading":return{...e,isLoading:!0};case"error":return{...t.payload,isLoading:!1,totalCount:0,items:[]};case"success":return{...t.payload,isLoading:!1};default:return{...e}}},D=e=>(e.page+1)*e.limit>=e.totalCount,M=e=>e.page*e.limit<=0,Z=(e,t)=>{switch(t.type){case"next":return D(e)?{...e}:{...e,page:e.page+1};case"previous":return M(e)?{...e}:{...e,page:e.page-1};case"update":return{...t.payload};default:return{...e}}},b=(e,t)=>{switch(e.size){case 0:return;case t:return"all";default:return e}},ee=(e,t)=>{switch(t.type){case"none":return;case"item":{if(!e)return new Set([t.payload.uid]);if(e==="all"){const s=new Set([...t.payload.items.map(l=>l.uid).filter(l=>l!==t.payload.uid)]);return b(s,t.payload.items.length)}if(!e.has(t.payload.uid)){const s=new Set([...e,t.payload.uid]);return b(s,t.payload.items.length)}const o=new Set([...e].filter(s=>s!==t.payload.uid));return b(o,t.payload.items.length)}case"all":return"all";default:return e?e==="all"?"all":{...e}:void 0}},te=(e,t)=>{switch(t.type){case"sort":return{...t.payload};default:return e?{...e}:void 0}},k=r.createContext(null),p=()=>{const e=r.useContext(k);if(!e)throw new Error("Could not find the AsyncListContext. Make sure you have a AsyncListContext.Provider defined above the current component.");return e};let m=!0;const ne={totalCount:0,items:[],isLoading:!1},se={totalCount:0,page:0,limit:5},xe=({load:e,defaultListState:t=ne,defaultPaginationState:o=se,...s})=>{const[l,f]=r.useReducer(Y,t),[d,w]=r.useReducer(Z,o),[E,C]=r.useReducer(ee,void 0),[c,T]=r.useReducer(te,void 0),x={states:{listState:l,paginationState:d,selectionState:E,sortState:c},dispatchers:{listDispatcher:f,paginationDispatcher:w,selectionDispatcher:C,sortDispatcher:T},...s},y=r.useCallback(async()=>{f({type:"loading"});const u=await e(x);u&&"error"in u&&f({type:"error",payload:u}),u&&"totalCount"in u&&"items"in u&&f({type:"success",payload:u})},[c==null?void 0:c.sortBy,c==null?void 0:c.sortOrder,d.page,d.limit]);return r.useEffect(()=>{m||C({type:"none"})},[c,d]),r.useEffect(()=>{m||w({type:"update",payload:{...d,page:0}})},[c]),r.useEffect(()=>{m||w({type:"update",payload:{...d,totalCount:l.totalCount}})},[l.totalCount]),r.useEffect(()=>{m||y()},[d.page,d.limit]),r.useEffect(()=>{m||d.page===0&&y()},[c==null?void 0:c.sortBy,c==null?void 0:c.sortOrder]),r.useEffect(()=>{m&&(m=!1,y())},[]),x},Re=e=>(r.useEffect(()=>{e.onSelection&&e.onSelection(e.states.selectionState)},[e.states.selectionState]),n(k.Provider,{value:e,children:n(oe,{})})),oe=()=>{const t={...p()};return delete t.states,delete t.dispatchers,delete t.allowSelection,delete t.columns,delete t.defaultSelection,delete t.onRowClick,delete t.onSelection,n(a,{as:"div",className:"overflow-auto",children:i(a,{as:"table",className:"table table-striped table-hover mb-0",...t,children:[n(le,{}),n(de,{}),n(he,{})]})})},ae=()=>{const e=r.useRef(null),t=p(),o=t.states.selectionState==="all",s=t.states.selectionState===void 0;return r.useEffect(()=>{if(e.current&&(o||s)){e.current.indeterminateOff();return}if(e.current){e.current.indeterminateOn();return}},[t.states.selectionState]),t.allowSelection?n(a,{as:"th",scope:"col",style:{maxWidth:"fit-content"},children:n(N,{ref:e,name:"selectAllRows",checked:o,onClick:()=>o?t.dispatchers.selectionDispatcher({type:"none"}):t.dispatchers.selectionDispatcher({type:"all"})})}):null},re=({label:e,sortOrder:t})=>i(a,{as:"span",className:"text-nowrap",children:[e," ",t==="asc"?"↑":t==="desc"?"↓":""]}),le=()=>{const e=p(),{columns:t}=e;return n(a,{as:"thead",children:i(a,{as:"tr",tabIndex:0,children:[n(ae,{}),t.map(({id:o,label:s,options:l,sortOrder:f})=>n(a,{as:"th",scope:"col",tabIndex:0,children:l!=null&&l.length?n(B,{children:i(a,{as:"div",className:"d-flex gap-2 justify-content-between align-items-end",children:[re({label:s,sortOrder:f}),n(h,{dropdown:n(h.Dropdown,{}),trigger:n(h.Trigger,{size:"sm"}),options:l,name:s})]})}):n(a,{as:"div",className:"d-flex gap-2 justify-content-between align-items-end",children:s})},o))]})})},P=(e,t)=>e instanceof Set&&e.has(t),ce=({uid:e})=>{const t=p(),o=g(t.states.selectionState),s=P(t.states.selectionState,e);return t.allowSelection?n(a,{as:"td",scope:"row",style:{maxWidth:"fit-content"},children:n(N,{name:"selectRow",checked:o||s,style:{marginRight:8},onClick:()=>{t.dispatchers.selectionDispatcher({type:"item",payload:{items:t.states.listState.items,uid:e}})}})}):null},ie=(e,t)=>{const o=g(e.states.selectionState),s=P(e.states.selectionState,t);return`${o||s?"table-info":""}`},de=()=>{const e=p();return n(a,{as:"tbody",children:e.states.listState.items.map((t,o)=>i(a,{as:"tr",className:ie(e,t.uid),tabIndex:0,onClick:e.onRowClick,children:[n(ce,{uid:t.uid}),e.columns.map(s=>n(a,{as:"td",scope:!e.allowSelection&&o===0?"row":"",tabIndex:0,children:s.renderCell?s.renderCell(t):t[s.key]},s.id))]},t.uid))})},g=e=>e==="all",ue=e=>e===void 0,me=(e,t)=>g(e)&&t>1?!0:e instanceof Set&&e.size>1,pe=e=>{const t=ue(e.states.selectionState),o=g(e.states.selectionState);return t?"":`${o?e.states.listState.items.length:e.states.selectionState.size} row${me(e.states.selectionState,e.states.listState.items.length)?"s":""} selected`},fe=e=>e.columns.length+(e.allowSelection?1:0),he=()=>{const e=p();return n(a,{as:"tfoot",children:n(a,{as:"tr",tabIndex:0,children:n(a,{as:"td",colSpan:fe(e),scope:"row",tabIndex:0,className:"border-bottom-0",children:n(be,{title:pe(e)})})})})},ge=e=>e.page*e.limit+1,we=e=>Math.min(e.totalCount,e.page*e.limit+e.limit),ye=e=>{const t=ge(e),o=we(e);return`${t} - ${o} of ${e.totalCount}`},be=({title:e})=>{const t=p(),o=ye(t.states.paginationState),s=M(t.states.paginationState),l=D(t.states.paginationState);return i(a,{as:"div",className:`d-flex gap-2 ${e?"justify-content-between":"justify-content-end"} align-items-center`,children:[e,i(a,{as:"div",className:"d-flex gap-2 align-items-center",children:[o,n(S,{disabled:s,onClick:s?void 0:()=>{t.dispatchers.paginationDispatcher({type:"previous"})},tabIndex:0,size:"sm",children:n(R,{icon:j})}),n(S,{disabled:l,onClick:l?void 0:()=>{t.dispatchers.paginationDispatcher({type:"next"})},tabIndex:0,size:"sm",children:n(R,{icon:z})})]})]})};export{Re as D,O as P,xe as u};
