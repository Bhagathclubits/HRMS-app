import{u as D,R as u,c as S,b as l,F as c,j as e,S as g,G as y,B as N,h as T,f as C,g as A,i as I,k as E,e as L,T as R}from"./index-4bbca3b0.js";import{D as h}from"./Dialog-227ac254.js";import{P as O}from"./PageHeader-7a080ab0.js";import{u as F,D as B}from"./DataGrid-87243675.js";import"./Checkbox-ff3f9a33.js";const x=()=>{const i=D(),[o,b]=u.useState(`${new Date}`),[a,r]=u.useState(`${new Date}`),[t,d]=u.useState([]),[m,v]=u.useState(),[p,f]=u.useState(0),w=async()=>{try{if(m===void 0)return;await S.leave.set.mutate({noOfDays:p,fromDate:o,toDate:a,leaveTypeId:m})}catch(n){T(n,i)}},s={id:"create-leave",labelId:"create-leave-label"};return u.useEffect(()=>{(async()=>{const n=await S.leaveType.getMany.query();d(n);const[k]=n;k!==void 0&&v(k.id)})()},[]),l(c,{children:[e(h.Trigger,{...s,variant:"primary",children:"Apply Leave"}),l(h,{...s,children:[e(h.Header,{title:"Add Leave"}),e(h.Body,{children:e(g,{gap:"3",children:l(y.Row,{gutters:"3",children:[e(y.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[e("input",{type:"number",className:"form-control",value:p,onChange:n=>f(parseInt(n.target.value))}),e("label",{htmlFor:"NoOfDays",children:"No Of Days"})]})}),e(y.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[e("input",{type:"date",className:"form-control",value:o,onChange:n=>b(n.target.value)}),e("label",{htmlFor:"From Date",children:"From Date"})]})}),e(y.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[e("input",{type:"date",className:"form-control",value:a,onChange:n=>r(n.target.value)}),e("label",{htmlFor:"TO Date",children:"To Date"})]})}),e(y.Col,{cols:["12","lg-6"],children:l("div",{className:"form-floating",children:[l("select",{className:"form-control",value:m,onChange:n=>v(parseInt(n.target.value)),children:[e("option",{value:void 0,children:"Select Leave Type"}),t.map(n=>e("option",{value:n.id,children:n.name}))]}),e("label",{htmlFor:"Leave Type",children:"Leave Type"})]})})]})})}),l(h.Footer,{children:[e(N,{variant:"outline-primary","data-bs-toggle":"modal","data-bs-target":`#${s.id}`,children:"Cancel"}),e(N,{variant:"primary",onClick:w,"data-bs-toggle":"modal","data-bs-target":`#${s.id}`,children:"Submit"})]})]})]})},P=i=>{const o=D(),[b,a]=u.useState([]),[r,t]=u.useState(),[d,m]=u.useState(""),[v,p]=u.useState(""),f=i.variant==="admin"?{labelId:"update-leave-status-model",id:"update-leave-status-model"}:{labelId:"update-leave-model",id:"update-leave-model"},w=async()=>{try{if(r===void 0)return;const s={id:i.leaveId,remarks:d,statusId:r},n=await S.leave.adminUpdate.mutate(s)}catch(s){T(s,o)}};return u.useEffect(()=>{p(i.variant)},[i.variant]),u.useEffect(()=>{(async()=>{const s=await S.leaveStatus.getMany.query();a(s);const[n]=s;n!==void 0&&t(n.id)})()},[]),l(c,{children:[e(h.Trigger,{...f,variant:"success",children:i.variant==="admin"?e(C,{icon:A}):e(C,{icon:I})}),e(h.Trigger,{...f,variant:"danger",children:i.variant==="admin"?e(C,{icon:E}):e(C,{icon:I})}),e(h,{...f,children:l("form",{onSubmit:w,className:"was-validated",children:[e(h.Header,{title:"Add Leave Status"}),e(h.Body,{children:l(g,{gap:"3",children:[l(g,{children:[e("label",{children:"Remarks"}),e("input",{type:"text",className:"form-control",placeholder:"Remarks",value:d,onChange:s=>m(s.target.value),required:!0})]}),l(g,{children:[e("label",{htmlFor:"status",children:"Status"}),e("select",{className:"form-control",value:r,onChange:s=>t(parseInt(s.target.value)),children:b.map(s=>e("option",{value:s.id,children:s.name}))})]})]})}),e(h.Footer,{children:e("div",{style:{width:"100%",display:"flex",justifyContent:"space-evenly",alignItems:"center"},children:e(N,{variant:"primary",className:"center",type:"submit","data-bs-toggle":"modal","data-bs-target":`#${f.id}`,children:"Confirm"})})})]})})]})},$=()=>{const i=D(),o=F({load:async({states:a})=>{var r,t;try{const d={sortBy:(r=a.sortState)==null?void 0:r.sortBy,sortOrder:(t=a.sortState)==null?void 0:t.sortOrder,limit:a.paginationState.limit,page:a.paginationState.page};console.log({inputParameters:d});const m=await S.leave.getMany.mutate(d);return console.log({result:m}),{totalCount:m.totalCount,items:m.items}}catch(d){return T(d,i),{error:new Error("Something went wrong")}}}});return e(g,{gap:"3",children:e(L,{children:e(B,{...o,columns:[{id:"1",key:"",label:"Empcode",renderCell:a=>e(c,{children:a.user.id})},{id:"2",key:"",label:"Emp Name",renderCell:a=>{var r,t;return l(c,{children:[(r=a.user.personalInfo)==null?void 0:r.firstName," ",(t=a.user.personalInfo)==null?void 0:t.lastName]})}},{id:"3",key:"",label:"Requested On",renderCell:a=>l(c,{children:[" ",new Intl.DateTimeFormat("en-US",{month:"numeric",year:"numeric",day:"numeric"}).format(new Date(a.createdAt))]})},{id:"4",key:"",label:"Leave Type",renderCell:a=>e(c,{children:a.leaveType.name})},{id:"5",key:"",label:"From",renderCell:a=>e(c,{children:new Intl.DateTimeFormat("en-US",{month:"numeric",year:"numeric",day:"numeric"}).format(new Date(a.fromDate))})},{id:"6",key:"",label:"To",renderCell:a=>e(c,{children:new Intl.DateTimeFormat("en-US",{month:"numeric",year:"numeric",day:"numeric"}).format(new Date(a.toDate))})},{id:"7",key:"noOfDays",label:"Days",renderCell:a=>e(c,{children:a.noOfDays})},{id:"8",key:"remarks",label:"Remarks"},{id:"8",key:"",label:"Status",renderCell:a=>e(R,{transform:"capitalize",color:a.status.name==="accepted"?"success":a.status.name==="rejected"?"danger":"warning",children:a.status.name})},{id:"9",key:"",label:"Action",renderCell:a=>{var r;return e(c,{children:e(P,{variant:((r=i.state.user)==null?void 0:r.role.name)==="admin"?"admin":"employee",leaveId:a.id})})}}].filter(a=>{var r;return console.log({auth:i}),a.label!=="Action"||((r=i.state.user)==null?void 0:r.role.name)==="admin"})})})})},U=()=>{var b,a,r;const i=D(),o=F({load:async({states:t})=>{var d,m;try{const v={sortBy:(d=t.sortState)==null?void 0:d.sortBy,sortOrder:(m=t.sortState)==null?void 0:m.sortOrder,limit:t.paginationState.limit,page:t.paginationState.page};console.log({inputParameters:v});const p=await S.leave.getMany.mutate(v);return console.log({result:p}),{totalCount:p.totalCount,items:p.items}}catch(v){return console.log(v),T(v,i),{error:new Error("Something went wrong")}}}});return e(g,{gap:"3",children:e(L,{children:e(B,{...o,columns:[{id:"2",key:"",label:"Emp Name",renderCell:t=>e(c,{children:t.user.personalInfo?`${t.user.personalInfo.firstName} ${t.user.personalInfo.lastName}`:""}),sortOrder:((b=o.states.sortState)==null?void 0:b.sortBy)==="status"&&o.states.sortState.sortOrder?o.states.sortState.sortOrder:void 0,options:[{id:"1",as:"button",icon:"↑",label:"Sort by ASC",disabled:((a=o.states.sortState)==null?void 0:a.sortBy)==="status"&&o.states.sortState.sortOrder==="asc",onClick:()=>{o.dispatchers.sortDispatcher({type:"sort",payload:{sortBy:"status",sortOrder:"asc"}})}},{id:"2",as:"button",icon:"↓",label:"Sort by DESC",disabled:((r=o.states.sortState)==null?void 0:r.sortBy)==="status"&&o.states.sortState.sortOrder==="desc",onClick:()=>{o.dispatchers.sortDispatcher({type:"sort",payload:{sortBy:"status",sortOrder:"desc"}})}}]},{id:"3",key:"",label:"Leave Type",renderCell:t=>e(c,{children:t.leaveType.name})},{id:"4",key:"",label:"Available Units",renderCell:t=>e(c,{children:t.leaveType.daysAlloted})},{id:"5",key:"",label:"Balance Units",renderCell:t=>e(c,{children:Number(t.leaveType.daysAlloted)-Number(t.noOfDays)})}]})})})},V=()=>e(c,{children:l(g,{gap:"3",children:[l(y.Row,{children:[e(y.Col,{className:"py-2",cols:["12","md-2"],children:e("input",{type:"text",className:"form-control form-control-sm",placeholder:"From"})}),e(y.Col,{className:"py-2",cols:["12","md-2"],children:e("input",{type:"text",className:"form-control form-control-sm",placeholder:"To"})}),e(y.Col,{className:"py-2",cols:["12","md-2"],children:e("input",{type:"text",className:"form-control form-control-sm",placeholder:"Leave Type"})}),e(y.Col,{className:"py-2",cols:["12","md-2"],children:e(N,{variant:"primary",className:"w-100",children:"Search"})})]}),e(O,{title:e(O.Title,{}),actions:e(x,{})}),l("ul",{className:"nav nav-tabs",id:"myTab",role:"tablist",children:[e("li",{className:"nav-item",role:"presentation",children:e("button",{className:"nav-link active",id:"viewleave-tab","data-bs-toggle":"tab","data-bs-target":"#viewleave",type:"button",role:"tab","aria-controls":"viewleave","aria-selected":"true",children:"Leaves"})}),e("li",{className:"nav-item",role:"presentation",children:e("button",{className:"nav-link",id:"leavebalance-tab","data-bs-toggle":"tab","data-bs-target":"#leavebalance",type:"button",role:"tab","aria-controls":"leavebalance","aria-selected":"false",children:"Balance"})})]}),l("div",{className:"tab-content",id:"myTabContent",children:[e("div",{className:"tab-pane fade show active",id:"viewleave",role:"tabpanel","aria-labelledby":"viewleave-tab",children:e($,{})}),e("div",{className:"tab-pane fade",id:"leavebalance",role:"tabpanel","aria-labelledby":"leavebalance-tab",children:e(U,{})})]})]})});export{V as LeaveTabs,V as default};
